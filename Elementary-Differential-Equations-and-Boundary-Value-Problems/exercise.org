:PROPERTIES:
:header-args:python: :session "calpy" :results silent
:END:

* Chapter 1: Introduction

#+begin_src python
  import numpy as np
  import matplotlib.pyplot as plt
  import math

  def show_direction_field(F, xr, yr):
      x_vals = np.linspace(xr[0], xr[1], 20)
      y_vals = np.linspace(yr[0], yr[1], 20)
      X, Y = np.meshgrid(x_vals, y_vals)
      M = F(X, Y)

      # Define direction vectors (1, M) and normalize if desired
      U = np.ones_like(M)
      V = M

      plt.quiver(X, Y, U, V, angles='xy', scale_units='xy', pivot='middle')
      plt.gca().set_aspect('auto')
      plt.xlabel('x')
      plt.ylabel('y')
      plt.title('Direction Field with Arrows')
      plt.show()
#+end_src

** 1.1

*** 1

#+begin_src python
  show_direction_field(lambda x, y: 3-2*y, (-1, 1), (-10, 10))
#+end_src

*** 2

#+begin_src python
  show_direction_field(lambda x, y: 2*y-3, (-1, 1), (-10, 10))
#+end_src

*** 3

#+begin_src python
  show_direction_field(lambda x, y: -1-2*y, (-1, 1), (-10, 10))
#+end_src

*** 4

#+begin_src python
  show_direction_field(lambda x, y: 1+2*y, (-1, 1), (-10, 10))
#+end_src

*** 5

$dy/dt = ay - {2\over3}a$ for all $a < 0$.

*** 6

$dy/dt = ay - 2a$ for all $a > 0$.

*** 7

#+begin_src python
  show_direction_field(lambda x, y: y*(4-y), (-1, 1), (-1, 6))
#+end_src

*** 8

#+begin_src python
  show_direction_field(lambda x, y: -y*(5-y), (-1, 1), (-1, 6))
#+end_src

*** 9

#+begin_src python
  show_direction_field(lambda x, y: y**2, (-1, 1), (-1, 1))
#+end_src

*** 10

#+begin_src python
  show_direction_field(lambda x, y: y*(y-2)**2, (-1, 1), (-1, 3))
#+end_src

*** 11

j

*** 12

c

*** 13

g

*** 14

b

*** 15

h

*** 16

d

*** 17

(a) $q$: amount of chemical in grams, $t$: passsed time in hours.
$$ dq/dt = 300 * \Bigl(0.01 - {q\over 1000000}\Bigr) $$.

(b) $10000$ grams, no.

*** 18

$$ dv/dt = -kv^{2/3}$$, assume that the constnat $k$ is $1$:

#+begin_src python
  show_direction_field(lambda x, y: -y**(2/3), (0, 10), (0, 10))
#+end_src

*** 19

$T$: the temperature of the object,
$$ {dT\over dt} = -0.05(T-70) $$.

*** 20

(a) $q$: the amount of the drug,
$$ {dq\over dt} = 500 - 0.4\,q $$.

(b) $500 / 0.4 = 1250$ mg.

*** 21

(a) $$ {dv\over dt} = g - {\gamma\over m}v^2 $$.

(b) $\sqrt{mg/\gamma}$.

(c) $0.0408$.

(d)

#+begin_src python
  show_direction_field(lambda x, y: 9.8 - 0.00408 * y**2, (0, 10), (0, 100))
#+end_src

*** 22

#+begin_src python
  show_direction_field(lambda x, y: -2 + x - y, (0, 20), (-10, 10))
#+end_src

*** 23

#+begin_src python
  show_direction_field(lambda x, y: math.e**x + y, (-2, 10), (-10000, 10000))
#+end_src

*** 24

#+begin_src python
  show_direction_field(lambda x, y: 3 * np.sin(x) + 1 + y, (0, 10), (-10, 10))
#+end_src

*** 25

#+begin_src python
  show_direction_field(lambda x, y: -(2 * x + y)/(2*y), (0, 10), (-10, 10))
#+end_src



