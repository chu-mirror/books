\def\newex#1{\noindent{\bf #1} }
\def\ldot{\,.\,}
\def\alphaeq{=_\alpha}
\def\betaeq{=_\beta}
\def\betatr{\to_\beta}
\def\betatrr{\to\!\!\!\!\!\to_\beta}
\def\nextquestion{\par\noindent}
\newex{1.1} (a) $$\eqalign{
(\lambda x\ldot(((xz)y)(xx)))
&\equiv\lambda x\ldot(((xz)y)(xx))\cr
&\equiv\lambda x\ldot((xz)y)(xx)\cr
&\equiv\lambda x\ldot(xz)y(xx)\cr
&\equiv\lambda x\ldot xzy(xx)\cr}$$
(b) $$\eqalign{
((\lambda x\ldot(\lambda y\ldot(\lambda z\ldot(z((xy)z)))))(\lambda u\ldot u))
&\equiv(\lambda x\ldot(\lambda y\ldot(\lambda z\ldot(z((xy)z)))))(\lambda u\ldot u)\cr
&\equiv(\lambda xy\ldot(\lambda z\ldot(z((xy)z))))(\lambda u\ldot u)\cr
&\equiv(\lambda xyz\ldot(z((xy)z)))(\lambda u\ldot u)\cr
&\equiv(\lambda xyz\ldot z((xy)z))(\lambda u\ldot u)\cr
&\equiv(\lambda xyz\ldot z(xyz))(\lambda u\ldot u)\cr}$$

\newex{1.2} (a) Yes. (b) No, $y\in FV(y)$ but $x$ is a binding variable.
(c) No, $x\in FV(x)$.

\newex{1.3} Given $z\notin FV(x(\lambda z\ldot y))$ and $x\notin FV(\lambda z\ldot y)$, $$
\eqalign{\lambda x\ldot x(\lambda z\ldot y)
&\alphaeq \lambda z \ldot (x(\lambda z\ldot y))^{x\to z}\cr
&\equiv \lambda z \ldot z(\lambda z\ldot y).\cr}$$

\newex{1.4} (a) $$
\{(\lambda z\ldot zxz)((\lambda y\ldot xy)x),
(\lambda z\ldot zxz), ((\lambda y\ldot xy)x),
zxz, (\lambda y\ldot xy), x,
zx, xy,
y, z
\}.$$
(b) (TODO)\nextquestion
(c) $$
\eqalign{
FV(U)
&= FV(\lambda z\ldot zxz)\cup FV((\lambda y\ldot xy)x)\cr
&= (FV(zxz)\!\setminus\!\{z\})\cup(FV(\lambda y\ldot xy)\cup FV(x))\cr
&= \{x\} \cup \{x\}\cr
&= \{x\}\cr
}
$$
(d) Given the lemma, $$
M_1N_1\alphaeq M_2N_2 \iff M_1\alphaeq M_2 \quad\hbox{and}\quad N_1\alphaeq N_2,
$$ it's easy to reduce the original problems to smaller problems.

\newex{1.5} (a) $$
\eqalign{
(\lambda x\ldot y(\lambda y\ldot xy))[y := \lambda z\ldot zx]
&\equiv\lambda u\ldot (y(\lambda y\ldot uy))[y := \lambda z\ldot zx]\cr
&\equiv\lambda u\ldot y[y := \lambda z\ldot zx](\lambda y\ldot uy)[y := \lambda z\ldot zx]\cr
&\equiv\lambda u\ldot (\lambda z\ldot zx)(\lambda v\ldot uv)[y := \lambda z\ldot zx]\cr
&\equiv\lambda u\ldot (\lambda z\ldot zx)(\lambda v\ldot (uv)[y := \lambda z\ldot zx])\cr
&\equiv\lambda u\ldot (\lambda z\ldot zx)(\lambda v\ldot uv)\cr
}
$$
(b) $$
\eqalign{
((xyz)[x:=y])[y:=z]
&\equiv((xy)[x:=y]z)[y:=z]\cr
&\equiv(x[x:=y]yz)[y:=z]\cr
&\equiv(yyz)[y:=z]\cr
&\equiv zzz\cr
}
$$
(c) $$
\eqalign{
((\lambda x\ldot xyz)[x:=y])[y:=z]
&\equiv(\lambda u\ldot (uyz)[x:=y])[y:=z]\cr
&\equiv(\lambda u\ldot (uyz))[y:=z]\cr
&\equiv\lambda u\ldot (uyz)[y:=z]\cr
&\equiv\lambda u\ldot uzz\cr
}
$$
(d) $$
\eqalign{
(\lambda y\ldot yyx)[x:=yz]
&\equiv\lambda u\ldot (uux)[x:=yz]\cr
&\equiv\lambda u\ldot uu(yz)\cr
}
$$

\newex{1.6} Try $M:=xy$, $N:=y$, $L:=z$, then $$
(xy)[x:=y, y:=z]\equiv yz,
$$
but $$
(xy)[x:=y][y:=z]\equiv zz.
$$

\newex{1.7} (a) $(\lambda z\ldot zxz)((\lambda y\ldot xy)x)$ and $(\lambda y\ldot xy)x$.\nextquestion
(b) First, $$
\eqalign{(\lambda z\ldot zxz)((\lambda y\ldot xy)x)
&\betatr ((\lambda y\ldot xy)x)x((\lambda y\ldot xy)x)\cr
&\betatr xxx((\lambda y\ldot xy)x)\cr
&\betatr xxx(xx),\cr}$$
Second, $$
\eqalign{(\lambda z\ldot zxz)((\lambda y\ldot xy)x)
&\betatr ((\lambda y\ldot xy)x)x((\lambda y\ldot xy)x)\cr
&\betatr ((\lambda y\ldot xy)x)x(xx)\cr
&\betatr xxx(xx),\cr}$$
Third, $$
\eqalign{(\lambda z\ldot zxz)((\lambda y\ldot xy)x)
&\betatr (\lambda z\ldot zxz)(xx)\cr
&\betatr xxx(xx),\cr}$$

\newex{1.8} We can start from the lemma: $$
\hbox{if}\quad M \betaeq N \quad\hbox{then}\quad FV(M) = FV(N).
$$ Of course, $FV(yy) \neq FV(xx)$.

\newex{1.9} (a) $$\eqalign{
(\lambda xy\ldot x)\,P\,Q
&\betatr (\lambda y\ldot P) Q\cr
&\betatr P\cr
}$$
$$\eqalign{
(\lambda xyz\ldot xz(yz))\,P\,Q\,R
&\betatr (\lambda yz\ldot P\,z(yz))\,Q\,R\cr
&\betatr (\lambda z\ldot P\,z(Q\,z))\,R\cr
&\betatr P\,R\,(Q\,R)\cr
}
$$
(b) $$\eqalign{
(\lambda xyz\ldot xz(yz))\,K\,K
&\betatr (\lambda yz\ldot K\,z(yz))\,K\cr
&\betatr (\lambda yz\ldot z)\,K\cr
&\betatr \lambda z\ldot z\cr
}$$
(c) $$\eqalign{
(\lambda xyz\ldot xz(yz))\,(K\,S)K\,U\,V\,W
&\betatr (\lambda yz\ldot (K\,S)z(yz))\,K\,U\,V\,W\cr
&\betatr (\lambda yz\ldot S\,(yz))\,K\,U\,V\,W\cr
&\betatr (\lambda z\ldot S\,(K\,z))\,U\,V\,W\cr
&\betatr S\,(K\,U)\,V\,W\cr
&\betatrr (K\,U)\,W\,(V\,W)\cr
&\betatrr U\,(V\,W)\cr
}$$
(d) $$\eqalign{
S\,S\,S\,K\,K
&\betatrr S\,K\,(S\,K)\,K\cr
&\betatrr K\,K\,(S\,K)\cr
&\betatrr K\cr
}$$
$$\eqalign{
S\,K\,K\,K
&\betatrr K\,K\,(K\,K)\cr
&\betatrr K\cr
}$$

\newex{1.10} (a) $$
\eqalign{
\hbox{\it add}\,\hbox{\it one}\,\hbox{\it one}
&\betatrr \lambda fx\ldot\hbox{\it one}\,f\,(\hbox{\it one}\,f\,x)\cr
&\betatrr \lambda fx\ldot f\,(\hbox{\it one}\,f\,x)\cr
&\betatrr \lambda fx\ldot f\,(f\,x)\cr
&\equiv\hbox{\it two}
}
$$
(b) (TODO)

\newex{1.11} (SKIP)

\newex{1.12} (SKIP)

\newex{1.13} (a) (SKIP)\nextquestion
(b) If $n\neq 0$, then there exists $n'$ that $n \equiv \lambda fx\ldot f\,(n'\,x)$,
$$\eqalign{
\hbox{\it iszero}\,n
&\betatr n(\lambda x\ldot \hbox{\it false})\,\hbox{\it true}\cr
&\equiv (\lambda fx\ldot f\,(n'\,x))(\lambda x\ldot \hbox{\it false})\,\hbox{\it true}\cr
&\betatr (\lambda x\ldot (\lambda x\ldot \hbox{\it false})\,(n'\,x))\,\hbox{\it true}\cr
&\betatr (\lambda x\ldot \hbox{\it false})\,(n'\,\hbox{\it true})\cr
&\betatr \hbox{\it false}.\cr
}$$

\newex{1.14} (SKIP)

\newex{1.15} Prove it by counting the number of redex.

\newex{1.16} (a) There exists an $\beta$-nf $N$ that $M\betaeq N$, because $M_i\betaeq M$, from
the transitivity of $\beta$-equivalence, $M_i\betaeq N$. \nextquestion
(b) $\hbox{\it true}\,\hbox{\it true}\,\Omega$.

\newex{1.17} If $M$ or $N$ has an infinite reduction path, then~$MN$ must also have one, but it's impossible.
($M\betatr M'$ implies $MN\betatr M'N$)

\newex{1.18} It's easy to prove $M\betaeq N$, then from lemma 1.9.10, $M\betatrr N$.

\newex{1.19} $$
\eqalign{
ZM
&\equiv UUM\cr
&\betatr M(UUM)\cr
&\equiv M(ZM)\cr
}$$

\newex{1.20} (a) Let $L = \lambda m\ldot (\lambda xy\ldot xmy)$, $M = YL$.\nextquestion
(b) Try to solve $M = \lambda xyz \ldot xyzM$.

\newex{2.1} (a) Not, $xx$ can not be typed.\nextquestion
(b) $x: A\to A\to B$, $y: A$.\nextquestion
(c) Not, $x$ receives itself as argument.\nextquestion
(d) $x: A\to A$, $y: A$.\nextquestion
(e) $x: A\to B$, $y: (A\to B)\to A$.

\newex{2.2} $(X\to Y)\to X\to Y$.

\newex{2.3} $K: A\to B\to A$, $S: (C\to D\to E)\to(C\to D)\to C\to E$.

\newex{2.4} (a) $x: A\to B$, $y: C\to A$, $z: C$.\nextquestion
(b) $x: A\to B$, $y: B\to(A\to B)\to C$, $z: A$.

\newex{2.5} (a) $x: (A\to B)\to (A\to C)$, $y: B$, $z: A$.\nextquestion
(b) Not.

\newex{2.6} (TODO)

\newex{2.7} (a) If $f: A\to B$, $x: A$, then $f\,x: B$. If $g: B\to C$, then $g(f\,x):C$.
Then if $f: A\to B$, $g: B\to C$, $g\circ f: A\to C$.\nextquestion
(b) If $A\Rightarrow B$ and $A$, then $B$. If $B\Rightarrow C$, then $C$. Then
$(A\Rightarrow B)\Rightarrow ((B\Rightarrow C)\Rightarrow (A\Rightarrow C))$.\nextquestion
(c) (TODO) \nextquestion
(d) They all follows a similar pattern of {\it appl}, {\it appl}, {\it abst}.

\newex{2.8} (a) $x: \gamma \to \beta$, $y: (\gamma\to\beta)\to\beta$, $z: \gamma$.\nextquestion
(b) (TODO) \nextquestion
(c) (TODO) \nextquestion
(d) (TODO) \nextquestion

\newex{2.9} (TODO)

\newex{2.10} (TODO)

\newex{2.11} (a) $\lambda x: \alpha\to\alpha\to\gamma\ldot\lambda y: \alpha\ldot\lambda z: \beta\ldot xyy$\nextquestion
(b) $\lambda x: (\alpha\to\gamma)\to\alpha\ldot\lambda y:\alpha\to\gamma\ldot\lambda z:\beta\ldot y(xy)$

\newex{2.12} (a) $\tau=\lambda x:(\alpha\to\beta)\to\alpha\ldot\lambda y:\alpha\to\alpha\to\beta\ldot
x(\lambda z:\alpha\ldot yzz)$\nextquestion
(b) $\lambda x:(\alpha\to\beta)\to\alpha\ldot\lambda y:\alpha\to\alpha\to\beta\ldot
y(\tau xy)(\tau xy)$

\newex{2.13} (a) $\lambda y: \alpha\to\beta\ldot\lambda z:\alpha\ldot xz(yz)$\nextquestion
(b) $\lambda y:\alpha\ldot\lambda z:\alpha\to\beta\ldot xy(zy)y$\nextquestion
(c) $\lambda y:\alpha\to\gamma\ldot\lambda z:\beta\to\alpha\ldot x(\lambda u:\beta\ldot y(zu))$

\newex{2.14} $\lambda y:\alpha\ldot\lambda z:\beta\ldot x(\lambda u:\gamma\ldot z)y$

\newex{2.15} (TODO)

\newex{2.16} (TODO)

\newex{2.17} (TODO)

\newex{2.18} (TODO)

\bye
